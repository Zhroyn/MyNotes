<!-- TOC -->

- [内置常量](#内置常量)
- [常用函数](#常用函数)
  - [数字I/O](#数字io)
  - [模拟I/O](#模拟io)
  - [串口操作](#串口操作)
  - [时间函数](#时间函数)
- [硬件开发](#硬件开发)
  - [Arduino Uno](#arduino-uno)
  - [按键开关](#按键开关)
  - [PWM（脉冲宽度调制）](#pwm脉冲宽度调制)
  - [蜂鸣器](#蜂鸣器)
  - [74595 接口扩展](#74595-接口扩展)
  - [舵机](#舵机)
  - [步进电机](#步进电机)
  - [红外遥控](#红外遥控)
  - [超声波测距](#超声波测距)
  - [继电器](#继电器)

<!-- /TOC -->







## 内置常量
- 引脚常量：
  - `INPUT` 将该引脚设置为输入引脚
  - `OUTPUT` 将引脚设置为输出引脚
  - `INPUT_PULLUP` 将该引脚设置为内部上拉电阻
<br>

- 电压常量：
  - `HIGH` 高水平的电压，取决于硬件，在3.3V的板子上大于2V，在5V的板子上大于3V
  - `LOW` 低水平的电压，同样取决于所使用的板子
<br>

- 数字常量：
  - `M_PI` 常数pi
  - `M_E` 常数e
  - `M_LN10` 数字10的自然对数
  - `M_LN2` 数字2的自然对数
  - `M_LOG10E` e的对数，以10为底
  - `M_LOG2E` e的对数，以2为底
  - `M_SQRT2` 2的平方根
  - `NAN` NAN（不是一个数字）常数
- 逻辑常量：
  - `true`
  - `false`
<br>

- `LED_BUILTIN` : 13
- `A0` `PIN_A0` : 14
- `A1` `PIN_A1` : 15
- `A2` `PIN_A2` : 16
- `A3` `PIN_A3` : 17
- `A4` `PIN_A4` : 18
- `A5` `PIN_A5` : 19
- `A6` `PIN_A6` : 20
- `A7` `PIN_A7` : 21





## 常用函数
### 数字I/O
- `pinMode(pin, mode)` 设置一个引脚为输入或输出
- `digitalWrite(pin, val)` 给一个数字引脚写入 `HIGH` 或 `LOW`
- `digitalRead(pin)` 从一个数字引脚读取数值，返回 `HIGH` 或 `LOW`


### 模拟I/O
- `analogRead(pin)` 从一个模拟引脚读取数值。返回一个0-1023之间的整数，对应着0-5V
- `analogWrite(pin, val)` 从一个引脚输出PWM模拟值。输入一个0-255之间的整数，对应着0-5V


### 串口操作
- `Serial.begin(baud)` 开启串口并设置波特率
<br>

- `Serial.read()` 读取串口缓存中的一个字符并删除
- `Serial.print(val)` or `Serial.print(val, format)`
  - 写入字符串数据到串口
  - 转换进制
    - `Serial.print(78, BIN)`
    - `Serial.print(78, OCT)`
    - `Serial.print(78, DEC)`
    - `Serial.print(78, HEX)`
  - 四舍五入
    - `Serial.print(1.23456, 4) ==> 1.2346`
- `Serial.println(val)` or `Serial.println(val, format)`
  - 写入字符串数据到串口并换行
<br>


### 时间函数
- `delay(ms)` 暂定一段以毫秒为单位的时间
- `delayMicroseconds(ms)` 暂定一段以微秒为单位的时间
- `millis()` 返回程序开始运行时到现在的毫秒数
- `micros()` 返回程序开始运行时到现在的微秒数







## 硬件开发
### Arduino Uno
**数字端口**
- 数字信号有高电平和低电平两种形态
- 输出高电平时，可提供40mA的5V电压
<br>

- 数字端口既可用作输入，又可用作输出
- 使用前需用 `pinMode()` 指定是输入还是输出
<br>

- 引脚13连接板载的LED指示灯
- 引脚3、5、6、9、10、11具有PWM功能
- 引脚0、1可用作RX和TX串口，进行串口通讯

**模拟端口**
- 模拟端口 `A0~A5` 默认为模拟输入
- 也可用作数字输入、输出端口 `14~19`


### 按键开关
- 下拉电阻接法：按键接电源，电阻接地，输入端从中引出
  - 按键断开时，输入端读得低电平
  - 按键接通时，输入端读得高电平
  - 松开为低，按下为高
- 上拉电阻接法：按键接地，电阻接电源，输入端从中引出
  - 按键断开时，输入端读得高电平
  - 按键接通时，输入端读得低电平
  - 松开为高，按下为低


### PWM（脉冲宽度调制）
- Arduino通过在数字端口输出频繁切换的高低电平来产生模拟电平，其中产生的矩形波的高电平的持续时间称为**脉冲宽度**，其占一个周期的百分比称为**占空比**
- 输出模拟电压 = 占空比 × 电压幅度（5V）


### 蜂鸣器
- 有源蜂鸣器内部带震荡源，加上合适的直流电源就会鸣叫。向相应数字接口输出高低电平即可控制其鸣停
- 无源蜂鸣器内部不带震荡源，只加直流电源无法令其鸣叫，须用音频信号驱动才能鸣叫
<br>

- `tone(pin, frequency, duration=0)` 在一个引脚上产生一个方波（50%占空比）
  - `duration`：表示持续时间，以毫秒为单位
- `noTone(pin)` 在一个引脚上停止由 `tone()` 产生的波


### 74595 接口扩展


### 舵机
- 舵机转动角度是通过调节 PWM 信号占空比实现的
- 舵机内部电路产生的 PWM 信号周期固定为20ms，基准信号脉冲宽度为1.5ms，控制信号脉宽在 1ms 到 2ms 之间。不同品牌舵机对同一信号转动角度可能不同
- 舵机三根接线，分为接地、接电源和接信号，通常有以下两种：
  - 棕色接地、红色接电源、橙色接信号
  - 黑色接地、红色接电源、黄色接信号
- 控制舵机有两种方法：
  - 通过普通数字口产生不同占空比的方波，模拟 PWM 信号进行舵机定位
  - 利用 Arduino 自带的 Servo 函数控制。UNO 只能利用9口和10口控制2路舵机
<br>

- `#include <Servo.h>`
- `Servo myservo` 定义舵机变量名
- `myservo.attach(pin)` 设定舵机接口，仅数字9或10口可用
- `myservo.write(angle)` 设定舵机旋转角度，0°到180°
- `myservo.read()` 读取舵机角度
- `myservo.attached()` 判断舵机参数是否已发送到舵机所在接口
- `myservo.detach()` 使舵机与其接口分离，使该接口可继续被用作 PWM 接口


### 步进电机
- 四相步进电机，单电源直流供电
  - 定子四相绕组：A、B、C、D
  - 转子三对齿：03、14、25
- 对各相绕组按合适时序通电，就能使电机步进转动
- 开始时，开关 SB 闭合，SA、SC、SD 断开，则转子 03 号齿与 B 相磁极对齐，而 14号齿与 C、D 相磁极错齿，25号齿与 D、A 相磁极错齿。 
- 接着 SC 闭合，SB、SA、SD 断开，磁场使 14 号齿与 C 相磁极对齐，而 03 号齿与 A、B 相磁极错齿，25 号齿与A、D 相磁极错齿。转子转过 15°
- 以此类推，A、B、C、D 四相绕组轮流供电，则转子会沿着一定方向转动
<br>

- `#include <Stepper.h>`
- `Stepper stepper(steps, pin1, pin2, pin3, pin4)` 设置步进电机的步数和引脚
- `stepper.setSpeed(rpms)` 设置电机的转速，参数为每分钟电机转动的步数
- `stepper.step(steps)` 使电机转过固定的步数，当电机转过指定步数之后才会执行下一条语句


### 红外遥控
- `#include <IRremote.h>`
- `IRrecv irrecv(pin)` 初始化引脚为红外接收状态
- `decode_results results` 定义用于存储编码结果的对象
- `irrecv.decode(&results)` 判断是否接收到正确的红外信号，如果接收到，将红外信号进行解码，结果返回给results
- `irrecv.resume()` 清除红外传感器解码状态，准备接收下一个编码


### 超声波测距
- `pulseIn(pin, state, timeout=1000000L)` 测量一个脉冲信号的宽度，该脉冲信号可以是HIGH或LOW
  - 返回持续的微秒数，如果在超时时间内没有读到脉冲信号的话, 将返回0
  - 可检测的脉冲间隔时间范围是10微秒到3分钟

### 继电器






